<!-- place_list.html

<!DOCTYPE html>
<html>
<head>
    <title>Place List</title>
     Include Leaflet CSS and JS 
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
    <h1>Place List</h1>
 
    <form id="search-form">
        <input type="text" id="search-input" placeholder="Search places">
        <button type="submit">Search</button>
    </form>
    <br>
    <div id="map" style="height: 400px;"></div>

    <script>
        // var map = L.map('map').setView([0, 0], 2); // Set initial map view

        // // Add a default tile layer
        // L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        //     attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        // }).addTo(map);


        // // Function to add markers to the map based on place data

        // function addMarkersToMap(places) {
        //     if (places.length === 0) {
        //         alert('This place is not registered.');
        //     }
        //     else {
        //         places.forEach(place => {
        //         var marker = L.marker([place.latitude, place.longitude])
        //     .addTo(map)
        //     .bindPopup(`<b>${place.name}</b><br>${place.description}`);
        //     });
        //     }

// }
        // function addMarkersToMap(places) {
        //     places.forEach(place => {
        //         var marker = L.marker([place.latitude, place.longitude])
        //             .addTo(map)
        //             .bindPopup(`<b>${place.name}</b><br>${place.description}`);
        //     });
        // }

        // Function to handle form submission
    //     document.getElementById('search-form').addEventListener('submit', function (event) {
    //         event.preventDefault();
    //         const searchQuery = document.getElementById('search-input').value;

    //         // Fetch places based on the search query
    //         fetch(`/api/places/search/?search=${searchQuery}`)
    //             .then(response => response.json())
    //             .then(data => {
    //                 // Clear existing markers from the map
    //                 map.eachLayer(function (layer) {
    //                     if (layer instanceof L.Marker) {
    //                         map.removeLayer(layer);
    //                     }
    //                 });

    //                 // Add new markers to the map
    //                 addMarkersToMap(data);

    //                 // You can also use the data to display search results in the HTML template, if needed.
    //             })
    //             .catch(error => console.log(error));
    //     });

    //     // Initial fetch to load all places and add markers to the map

    //     fetch('/api/places/')
    // .then(response => response.json())
    // .then(data => {
    //     console.log(data); // Log the data to check its contents
    //     addMarkersToMap(data);
    // })
    // .catch(error => console.log(error));
    //     // fetch('/api/places/')
    //     //     .then(response => response.json())
    //     //     .then(data => {
    //     //         addMarkersToMap(data);
    //     //     })
    //     //     .catch(error => console.log(error));
    </script>
</body>
</html> 

-->


<!-- place_list.html 

<!DOCTYPE html>
<html>
<head>
    <title>Place List</title>
    Include Leaflet CSS and JS 
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
    <h1>Place List</h1>
    Search Form 
    <form id="search-form">
        <input type="text" id="search-input" placeholder="Search places">
        <button type="submit">Search</button>
    </form>
    <br>
    <div id="map" style="height: 400px;"></div>

    <script>
        var map = L.map('map').setView([0, 0], 2); // Set initial map view

        // Add a default tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to add markers to the map based on place data
        function addMarkersToMap(places) {
            if (places.length === 0) {
                alert('This place is not registered.');
            } else {
                places.forEach(place => {
                    var marker = L.marker([place.latitude, place.longitude])
                        .addTo(map)
                        .bindPopup(`<b>${place.name}</b><br>${place.description}`);
                });
            }
        }

        // Function to handle form submission
        document.getElementById('search-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const searchQuery = document.getElementById('search-input').value;

            if (searchQuery.trim() === '') {
                alert('Please enter a valid search query.');
            } else {
                // Fetch places based on the search query
                fetch(`/api/places/search/?search=${searchQuery}`)
                    .then(response => response.json())
                    .then(data => {
                        // Clear existing markers from the map
                        map.eachLayer(function (layer) {
                            if (layer instanceof L.Marker) {
                                map.removeLayer(layer);
                            }
                        });

                        // Add new markers to the map
                        addMarkersToMap(data);

                        // You can also use the data to display search results in the HTML template, if needed.
                    })
                    .catch(error => console.log(error));
            }
        });

        // Initial fetch to load all places and add markers to the map
        fetch('/api/places/')
            .then(response => response.json())
            .then(data => {
                addMarkersToMap(data);
            })
            .catch(error => console.log(error));
    </script>
</body>
</html> -->


<!-- place_list.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Place List</title>
    <!-- Include Leaflet CSS and JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
    <h1>Place List</h1>
    <!-- Search Form -->
    <form id="search-form">
        <input type="text" id="search-input" placeholder="Search places">
        <button type="submit">Search</button>
    </form>
    <br>
    <div id="map" style="height: 400px;"></div>

    <script>
        var map = L.map('map').setView([0, 0], 2); // Set initial map view

        // Add a default tile layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Function to add markers to the map based on place data
        function addMarkersToMap(places) {
            // Clear existing markers from the map
            clearMarkers();

            if (places.length === 0) {
                alert('This place is not registered.');
            } else {
                places.forEach(place => {
                    var marker = L.marker([place.latitude, place.longitude])
                        .addTo(map)
                        .bindPopup(`<b>${place.name}</b><br>${place.description}`);
                });
            }
        }

        // Function to clear all markers from the map
        function clearMarkers() {
            map.eachLayer(function (layer) {
                if (layer instanceof L.Marker) {
                    map.removeLayer(layer);
                }
            });
        }

        // Function to handle form submission
        document.getElementById('search-form').addEventListener('submit', function (event) {
            event.preventDefault();
            const searchQuery = document.getElementById('search-input').value;

            if (searchQuery.trim() === '') {
                alert('Please enter a valid search query.');
            } else {
                // Fetch places based on the search query
                fetch(`/api/places/search/?search=${searchQuery}`)
                    .then(response => response.json())
                    .then(data => {
                        // Add new markers to the map
                        addMarkersToMap(data);

                        // You can also use the data to display search results in the HTML template, if needed.
                    })
                    .catch(error => console.log(error));
            }
        });

        // Initial fetch to load all places and add markers to the map
        fetch('/api/places/')
            .then(response => response.json())
            .then(data => {
                addMarkersToMap(data);
            })
            .catch(error => console.log(error));
    </script>
</body>
</html>
